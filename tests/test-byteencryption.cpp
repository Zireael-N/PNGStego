//
// Copyright (C) 2015 Zireael (zireael dot nk at gmail dot com)
//  Distributed under the Boost Software License, Version 1.0.
//       (See accompanying file LICENSE.md or copy at
//           http://www.boost.org/LICENSE_1_0.txt)
//

#include <iostream>
#include <vector>
#include <random>
#include "byteencryption.h"

const std::vector<uint8_t> originalData =  { 66, 111, 111, 115, 116, 32, 83, 111, 102, 116, 119, 97, 114, 101, 32, 76, 105, 99, 101, 110, 115, 101, 32, 45, 32,
                                             86, 101, 114, 115, 105, 111, 110, 32, 49, 46, 48, 32, 45, 32, 65, 117, 103, 117, 115, 116, 32, 49, 55, 116, 104,
                                             44, 32, 50, 48, 48, 51, 10, 10, 80, 101, 114, 109, 105, 115, 115, 105, 111, 110, 32, 105, 115, 32, 104, 101, 114,
                                             101, 98, 121, 32, 103, 114, 97, 110, 116, 101, 100, 44, 32, 102, 114, 101, 101, 32, 111, 102, 32, 99, 104, 97, 114,
                                             103, 101, 44, 32, 116, 111, 32, 97, 110, 121, 32, 112, 101, 114, 115, 111, 110, 32, 111, 114, 32, 111, 114, 103, 97,
                                             110, 105, 122, 97, 116, 105, 111, 110, 10, 111, 98, 116, 97, 105, 110, 105, 110, 103, 32, 97, 32, 99, 111, 112, 121,
                                             32, 111, 102, 32, 116, 104, 101, 32, 115, 111, 102, 116, 119, 97, 114, 101, 32, 97, 110, 100, 32, 97, 99, 99, 111,
                                             109, 112, 97, 110, 121, 105, 110, 103, 32, 100, 111, 99, 117, 109, 101, 110, 116, 97, 116, 105, 111, 110, 32, 99, 111,
                                             118, 101, 114, 101, 100, 32, 98, 121, 10, 116, 104, 105, 115, 32, 108, 105, 99, 101, 110, 115, 101, 32, 40, 116, 104,
                                             101, 32, 34, 83, 111, 102, 116, 119, 97, 114, 101, 34, 41, 32, 116, 111, 32, 117, 115, 101, 44, 32, 114, 101, 112,
                                             114, 111, 100, 117, 99, 101, 44, 32, 100, 105, 115, 112, 108, 97, 121, 44, 32, 100, 105, 115, 116, 114, 105, 98, 117,
                                             116, 101, 44, 10, 101, 120, 101, 99, 117, 116, 101, 44, 32, 97, 110, 100, 32, 116, 114, 97, 110, 115, 109, 105, 116,
                                             32, 116, 104, 101, 32, 83, 111, 102, 116, 119, 97, 114, 101, 44, 32, 97, 110, 100, 32, 116, 111, 32, 112, 114, 101,
                                             112, 97, 114, 101, 32, 100, 101, 114, 105, 118, 97, 116, 105, 118, 101, 32, 119, 111, 114, 107, 115, 32, 111, 102, 32,
                                             116, 104, 101, 10, 83, 111, 102, 116, 119, 97, 114, 101, 44, 32, 97, 110, 100, 32, 116, 111, 32, 112, 101, 114, 109,
                                             105, 116, 32, 116, 104, 105, 114, 100, 45, 112, 97, 114, 116, 105, 101, 115, 32, 116, 111, 32, 119, 104, 111, 109, 32,
                                             116, 104, 101, 32, 83, 111, 102, 116, 119, 97, 114, 101, 32, 105, 115, 32, 102, 117, 114, 110, 105, 115, 104, 101, 100,
                                             32, 116, 111, 10, 100, 111, 32, 115, 111, 44, 32, 97, 108, 108, 32, 115, 117, 98, 106, 101, 99, 116, 32, 116, 111,
                                             32, 116, 104, 101, 32, 102, 111, 108, 108, 111, 119, 105, 110, 103, 58, 10, 10, 84, 104, 101, 32, 99, 111, 112, 121,
                                             114, 105, 103, 104, 116, 32, 110, 111, 116, 105, 99, 101, 115, 32, 105, 110, 32, 116, 104, 101, 32, 83, 111, 102, 116,
                                             119, 97, 114, 101, 32, 97, 110, 100, 32, 116, 104, 105, 115, 32, 101, 110, 116, 105, 114, 101, 32, 115, 116, 97, 116,
                                             101, 109, 101, 110, 116, 44, 32, 105, 110, 99, 108, 117, 100, 105, 110, 103, 10, 116, 104, 101, 32, 97, 98, 111, 118,
                                             101, 32, 108, 105, 99, 101, 110, 115, 101, 32, 103, 114, 97, 110, 116, 44, 32, 116, 104, 105, 115, 32, 114, 101, 115,
                                             116, 114, 105, 99, 116, 105, 111, 110, 32, 97, 110, 100, 32, 116, 104, 101, 32, 102, 111, 108, 108, 111, 119, 105, 110,
                                             103, 32, 100, 105, 115, 99, 108, 97, 105, 109, 101, 114, 44, 10, 109, 117, 115, 116, 32, 98, 101, 32, 105, 110, 99,
                                             108, 117, 100, 101, 100, 32, 105, 110, 32, 97, 108, 108, 32, 99, 111, 112, 105, 101, 115, 32, 111, 102, 32, 116, 104,
                                             101, 32, 83, 111, 102, 116, 119, 97, 114, 101, 44, 32, 105, 110, 32, 119, 104, 111, 108, 101, 32, 111, 114, 32, 105,
                                             110, 32, 112, 97, 114, 116, 44, 32, 97, 110, 100, 10, 97, 108, 108, 32, 100, 101, 114, 105, 118, 97, 116, 105, 118,
                                             101, 32, 119, 111, 114, 107, 115, 32, 111, 102, 32, 116, 104, 101, 32, 83, 111, 102, 116, 119, 97, 114, 101, 44, 32,
                                             117, 110, 108, 101, 115, 115, 32, 115, 117, 99, 104, 32, 99, 111, 112, 105, 101, 115, 32, 111, 114, 32, 100, 101, 114,
                                             105, 118, 97, 116, 105, 118, 101, 10, 119, 111, 114, 107, 115, 32, 97, 114, 101, 32, 115, 111, 108, 101, 108, 121, 32,
                                             105, 110, 32, 116, 104, 101, 32, 102, 111, 114, 109, 32, 111, 102, 32, 109, 97, 99, 104, 105, 110, 101, 45, 101, 120,
                                             101, 99, 117, 116, 97, 98, 108, 101, 32, 111, 98, 106, 101, 99, 116, 32, 99, 111, 100, 101, 32, 103, 101, 110, 101,
                                             114, 97, 116, 101, 100, 32, 98, 121, 10, 97, 32, 115, 111, 117, 114, 99, 101, 32, 108, 97, 110, 103, 117, 97, 103,
                                             101, 32, 112, 114, 111, 99, 101, 115, 115, 111, 114, 46, 10, 10, 84, 72, 69, 32, 83, 79, 70, 84, 87, 65, 82,
                                             69, 32, 73, 83, 32, 80, 82, 79, 86, 73, 68, 69, 68, 32, 34, 65, 83, 32, 73, 83, 34, 44, 32, 87, 73,
                                             84, 72, 79, 85, 84, 32, 87, 65, 82, 82, 65, 78, 84, 89, 32, 79, 70, 32, 65, 78, 89, 32, 75, 73, 78,
                                             68, 44, 32, 69, 88, 80, 82, 69, 83, 83, 32, 79, 82, 10, 73, 77, 80, 76, 73, 69, 68, 44, 32, 73, 78,
                                             67, 76, 85, 68, 73, 78, 71, 32, 66, 85, 84, 32, 78, 79, 84, 32, 76, 73, 77, 73, 84, 69, 68, 32, 84,
                                             79, 32, 84, 72, 69, 32, 87, 65, 82, 82, 65, 78, 84, 73, 69, 83, 32, 79, 70, 32, 77, 69, 82, 67, 72,
                                             65, 78, 84, 65, 66, 73, 76, 73, 84, 89, 44, 10, 70, 73, 84, 78, 69, 83, 83, 32, 70, 79, 82, 32, 65,
                                             32, 80, 65, 82, 84, 73, 67, 85, 76, 65, 82, 32, 80, 85, 82, 80, 79, 83, 69, 44, 32, 84, 73, 84, 76,
                                             69, 32, 65, 78, 68, 32, 78, 79, 78, 45, 73, 78, 70, 82, 73, 78, 71, 69, 77, 69, 78, 84, 46, 32, 73,
                                             78, 32, 78, 79, 32, 69, 86, 69, 78, 84, 10, 83, 72, 65, 76, 76, 32, 84, 72, 69, 32, 67, 79, 80, 89,
                                             82, 73, 71, 72, 84, 32, 72, 79, 76, 68, 69, 82, 83, 32, 79, 82, 32, 65, 78, 89, 79, 78, 69, 32, 68,
                                             73, 83, 84, 82, 73, 66, 85, 84, 73, 78, 71, 32, 84, 72, 69, 32, 83, 79, 70, 84, 87, 65, 82, 69, 32,
                                             66, 69, 32, 76, 73, 65, 66, 76, 69, 10, 70, 79, 82, 32, 65, 78, 89, 32, 68, 65, 77, 65, 71, 69, 83,
                                             32, 79, 82, 32, 79, 84, 72, 69, 82, 32, 76, 73, 65, 66, 73, 76, 73, 84, 89, 44, 32, 87, 72, 69, 84,
                                             72, 69, 82, 32, 73, 78, 32, 67, 79, 78, 84, 82, 65, 67, 84, 44, 32, 84, 79, 82, 84, 32, 79, 82, 32,
                                             79, 84, 72, 69, 82, 87, 73, 83, 69, 44, 10, 65, 82, 73, 83, 73, 78, 71, 32, 70, 82, 79, 77, 44, 32,
                                             79, 85, 84, 32, 79, 70, 32, 79, 82, 32, 73, 78, 32, 67, 79, 78, 78, 69, 67, 84, 73, 79, 78, 32, 87,
                                             73, 84, 72, 32, 84, 72, 69, 32, 83, 79, 70, 84, 87, 65, 82, 69, 32, 79, 82, 32, 84, 72, 69, 32, 85,
                                             83, 69, 32, 79, 82, 32, 79, 84, 72, 69, 82, 10, 68, 69, 65, 76, 73, 78, 71, 83, 32, 73, 78, 32, 84,
                                             72, 69, 32, 83, 79, 70, 84, 87, 65, 82, 69, 46 };

const std::vector<uint8_t> AESEncrypted = { 156, 6, 164, 96, 7, 139, 74, 16, 77, 55, 85, 82, 103, 128, 134, 76, 39, 173, 88, 172, 251, 29, 114, 211, 71,
                                            38, 225, 188, 116, 55, 164, 221, 52, 196, 106, 229, 173, 124, 14, 75, 152, 226, 209, 53, 14, 252, 191, 187, 243, 45,
                                            168, 146, 86, 109, 241, 36, 235, 109, 205, 73, 228, 230, 206, 151, 212, 202, 76, 233, 200, 227, 96, 214, 170, 47, 245,
                                            15, 156, 217, 217, 157, 18, 35, 57, 123, 157, 227, 44, 100, 73, 235, 69, 5, 226, 89, 218, 64, 166, 75, 159, 157,
                                            12, 82, 8, 13, 220, 224, 103, 128, 152, 125, 58, 173, 120, 108, 165, 230, 255, 9, 151, 207, 110, 189, 229, 7, 140,
                                            193, 218, 179, 64, 61, 147, 2, 148, 160, 39, 163, 177, 18, 147, 200, 48, 23, 7, 186, 29, 174, 244, 68, 128, 235,
                                            10, 130, 218, 112, 224, 204, 195, 69, 78, 206, 179, 156, 181, 156, 28, 151, 192, 57, 188, 54, 179, 150, 92, 149, 198,
                                            112, 94, 34, 223, 143, 68, 221, 103, 79, 246, 108, 124, 36, 39, 147, 131, 17, 104, 5, 204, 138, 123, 38, 151, 180,
                                            8, 175, 230, 70, 8, 14, 193, 225, 69, 158, 112, 242, 106, 77, 193, 125, 38, 6, 93, 190, 21, 14, 201, 64, 152,
                                            241, 184, 52, 181, 253, 154, 46, 215, 38, 184, 129, 236, 181, 132, 2, 148, 7, 113, 188, 194, 77, 233, 93, 254, 231,
                                            50, 5, 185, 203, 20, 13, 67, 151, 159, 41, 145, 65, 250, 80, 15, 33, 97, 209, 123, 67, 89, 134, 193, 95, 124,
                                            24, 83, 133, 83, 36, 152, 96, 178, 248, 40, 177, 127, 130, 216, 84, 162, 172, 173, 185, 16, 0, 57, 39, 67, 13,
                                            101, 245, 162, 49, 220, 105, 246, 37, 197, 212, 32, 140, 188, 111, 209, 238, 174, 136, 223, 249, 191, 142, 207, 130, 4,
                                            33, 162, 73, 197, 62, 51, 184, 196, 195, 164, 143, 38, 21, 166, 98, 32, 116, 171, 226, 252, 145, 118, 106, 133, 30,
                                            108, 211, 76, 238, 103, 125, 13, 42, 42, 5, 79, 236, 54, 73, 7, 189, 171, 152, 140, 86, 202, 155, 15, 79, 186,
                                            85, 112, 95, 166, 190, 210, 249, 2, 5, 37, 110, 227, 220, 97, 101, 9, 97, 214, 22, 209, 165, 25, 185, 90, 219,
                                            67, 244, 50, 112, 242, 74, 217, 173, 147, 118, 56, 189, 134, 54, 97, 102, 110, 118, 8, 119, 176, 25, 106, 57, 238,
                                            58, 116, 100, 172, 2, 8, 69, 48, 91, 39, 19, 224, 228, 170, 183, 77, 175, 34, 187, 165, 47, 123, 163, 95, 108,
                                            69, 165, 112, 61, 255, 6, 131, 235, 122, 96, 65, 144, 163, 158, 165, 68, 189, 226, 118, 199, 163, 47, 105, 159, 73,
                                            52, 194, 110, 154, 156, 144, 14, 167, 202, 252, 18, 41, 29, 106, 196, 66, 60, 92, 57, 47, 22, 246, 99, 118, 108,
                                            199, 130, 66, 117, 48, 89, 208, 1, 211, 4, 21, 226, 127, 42, 44, 180, 153, 78, 165, 191, 172, 124, 65, 18, 34,
                                            86, 174, 160, 58, 88, 215, 174, 39, 133, 205, 209, 130, 201, 208, 25, 157, 123, 192, 249, 41, 127, 242, 6, 153, 90,
                                            228, 53, 150, 78, 208, 161, 220, 68, 243, 110, 148, 211, 17, 242, 211, 137, 0, 215, 34, 54, 78, 254, 83, 192, 214,
                                            232, 18, 12, 182, 213, 77, 249, 96, 74, 112, 40, 64, 38, 65, 211, 216, 73, 26, 194, 94, 77, 112, 7, 201, 243,
                                            200, 151, 146, 207, 93, 44, 248, 108, 181, 159, 68, 209, 183, 193, 113, 30, 80, 72, 26, 51, 96, 26, 171, 183, 233,
                                            232, 167, 163, 200, 188, 193, 225, 140, 66, 61, 126, 51, 181, 7, 224, 0, 141, 128, 213, 151, 14, 174, 200, 144, 169,
                                            209, 109, 62, 49, 15, 6, 153, 85, 169, 124, 110, 253, 106, 221, 172, 218, 115, 112, 63, 209, 214, 207, 244, 61, 183,
                                            143, 131, 38, 90, 72, 9, 58, 71, 151, 27, 75, 214, 74, 153, 51, 153, 67, 91, 174, 39, 222, 234, 153, 160, 215,
                                            99, 249, 173, 185, 157, 98, 186, 216, 56, 255, 3, 254, 162, 236, 108, 238, 26, 234, 50, 133, 223, 235, 98, 179, 245,
                                            14, 179, 113, 82, 216, 228, 214, 46, 236, 164, 115, 14, 145, 85, 169, 41, 42, 164, 228, 100, 175, 114, 79, 239, 129,
                                            207, 253, 149, 66, 171, 10, 209, 181, 67, 149, 173, 58, 140, 234, 251, 129, 199, 206, 60, 227, 10, 139, 139, 117, 79,
                                            214, 120, 187, 66, 148, 59, 254, 65, 244, 105, 215, 238, 209, 37, 15, 232, 79, 118, 128, 101, 89, 6, 249, 113, 56,
                                            125, 192, 147, 41, 247, 8, 41, 94, 88, 212, 128, 69, 41, 129, 94, 113, 86, 252, 152, 110, 163, 173, 37, 211, 111,
                                            87, 67, 119, 38, 101, 181, 247, 207, 77, 77, 68, 168, 69, 76, 148, 175, 18, 253, 171, 56, 238, 186, 139, 33, 5,
                                            254, 145, 173, 33, 47, 136, 200, 118, 230, 124, 158, 122, 221, 165, 35, 189, 112, 225, 59, 8, 77, 205, 95, 44, 123,
                                            145, 119, 221, 13, 8, 233, 84, 214, 175, 249, 197, 107, 85, 128, 215, 28, 178, 159, 118, 77, 109, 145, 0, 235, 9,
                                            140, 23, 59, 50, 114, 108, 219, 47, 43, 186, 138, 10, 123, 117, 62, 50, 185, 128, 51, 246, 52, 94, 202, 168, 12,
                                            222, 165, 84, 0, 174, 189, 26, 229, 29, 131, 81, 238, 110, 12, 243, 222, 107, 191, 167, 59, 199, 50, 104, 72, 175,
                                            120, 206, 120, 103, 220, 65, 56, 90, 245, 22, 76, 156, 247, 230, 135, 240, 89, 130, 181, 27, 184, 120, 228, 57, 166,
                                            151, 51, 159, 147, 3, 130, 110, 232, 207, 197, 120, 61, 60, 135, 227, 135, 181, 245, 216, 144, 225, 63, 161, 44, 60,
                                            239, 160, 81, 135, 247, 93, 46, 118, 182, 59, 206, 231, 37, 88, 210, 182, 224, 239, 104, 45, 14, 148, 220, 217, 102,
                                            138, 162, 100, 68, 73, 236, 112, 227, 158, 213, 211, 83, 35, 190, 25, 11, 210, 222, 194, 61, 58, 131, 151, 213, 1,
                                            83, 242, 129, 165, 222, 29, 97, 136, 50, 134, 61, 167, 68, 252, 122, 88, 95, 223, 136, 123, 128, 97, 29, 139, 199,
                                            69, 219, 214, 120, 84, 60, 73, 212, 233, 50, 45, 3, 217, 77, 1, 224, 210, 2, 155, 203, 117, 98, 24, 191, 151,
                                            33, 210, 128, 53, 73, 40, 158, 52, 130, 5, 121, 180, 71, 79, 31, 87, 176, 175, 38, 146, 224, 72, 164, 226, 188,
                                            138, 88, 26, 211, 120, 49, 7, 32, 183, 134, 55, 131, 253, 212, 156, 135, 53, 77, 70, 251, 42, 191, 120, 0, 72,
                                            205, 111, 111, 253, 159, 98, 230, 81, 17, 254, 116, 212, 248, 201, 250, 115, 41, 95, 195, 81, 191, 4, 151, 96, 242,
                                            130, 214, 16, 121, 51, 87, 239, 137, 225, 247, 20, 9, 113, 200, 52, 54, 136, 77, 23, 242, 198, 41, 66, 178, 158,
                                            117, 135, 25, 126, 171, 28, 156, 101, 92, 74, 202, 75, 99, 145, 43, 104, 165, 26, 232, 210, 199, 17, 46, 90, 20,
                                            99, 186, 113, 38, 138, 0, 25, 132, 216, 177, 191, 104, 162, 233, 215, 131, 177, 72, 97, 94, 248, 152, 31, 56, 8,
                                            81, 42, 14, 181, 170, 93, 203, 114, 212, 209, 20, 199, 248, 216, 162, 6, 25, 232, 235, 236, 126, 14, 37, 125, 32,
                                            3, 76, 143, 254, 153, 151, 97, 187, 224, 175, 233, 136, 158, 116, 6, 36, 165, 164, 105, 227, 173, 115, 118, 184, 236,
                                            136, 104, 41, 117, 201, 115, 40, 192, 111, 130, 171, 174, 186, 44, 245, 95, 85, 226, 39, 39, 51, 113, 128, 107, 185,
                                            140, 79, 90, 133, 254, 171, 143, 38, 79, 93, 82, 243, 139, 57, 14, 186, 58, 221, 25, 14, 136, 118, 181, 30 };

const std::vector<uint8_t> SerpentEncrypted = { 175, 6, 94, 82, 173, 206, 149, 242, 33, 131, 94, 210, 58, 234, 110, 7, 195, 112, 100, 243, 199, 254, 8, 79, 225,
                                                156, 197, 159, 43, 94, 56, 113, 7, 34, 107, 67, 15, 170, 219, 128, 9, 226, 126, 209, 181, 219, 28, 1, 13, 93,
                                                137, 96, 182, 174, 71, 247, 60, 33, 7, 17, 255, 67, 123, 79, 35, 243, 252, 86, 239, 45, 191, 253, 128, 242, 241,
                                                42, 52, 46, 14, 62, 124, 197, 67, 83, 193, 176, 74, 4, 161, 100, 60, 242, 192, 145, 143, 254, 126, 212, 23, 47,
                                                69, 229, 7, 232, 224, 42, 171, 142, 10, 241, 134, 53, 131, 159, 162, 149, 255, 237, 98, 139, 105, 54, 190, 114, 18,
                                                140, 9, 138, 193, 59, 54, 60, 31, 176, 159, 172, 104, 100, 162, 93, 210, 190, 96, 104, 72, 175, 3, 210, 235, 107,
                                                150, 128, 216, 16, 214, 199, 26, 9, 63, 109, 159, 237, 219, 145, 142, 24, 171, 145, 239, 33, 190, 37, 98, 4, 78,
                                                157, 221, 109, 78, 252, 239, 195, 65, 12, 190, 39, 164, 83, 237, 232, 214, 135, 137, 24, 191, 15, 228, 59, 245, 207,
                                                155, 91, 8, 118, 153, 35, 211, 243, 237, 35, 165, 242, 188, 160, 130, 97, 246, 68, 154, 74, 98, 7, 161, 171, 13,
                                                215, 163, 174, 251, 52, 0, 249, 45, 146, 112, 94, 39, 114, 110, 250, 242, 128, 196, 229, 213, 3, 175, 118, 104, 2,
                                                236, 189, 216, 128, 144, 62, 13, 99, 57, 252, 227, 36, 138, 221, 32, 45, 79, 231, 88, 162, 87, 195, 175, 106, 177,
                                                183, 165, 253, 230, 176, 140, 116, 94, 227, 224, 230, 164, 187, 23, 55, 67, 216, 125, 242, 89, 55, 56, 56, 129, 115,
                                                68, 129, 166, 113, 186, 75, 107, 175, 129, 27, 164, 8, 76, 170, 183, 19, 217, 202, 119, 126, 84, 30, 128, 79, 81,
                                                84, 58, 205, 35, 189, 249, 66, 204, 65, 6, 25, 12, 204, 62, 150, 242, 118, 101, 249, 29, 233, 119, 50, 231, 131,
                                                225, 160, 160, 106, 235, 95, 235, 187, 242, 111, 186, 101, 149, 129, 73, 2, 125, 253, 93, 251, 161, 253, 238, 172, 209,
                                                194, 251, 123, 249, 249, 174, 140, 198, 25, 101, 185, 241, 53, 236, 134, 139, 46, 52, 216, 99, 37, 80, 21, 18, 75,
                                                182, 40, 14, 199, 204, 212, 76, 153, 64, 38, 135, 121, 138, 218, 175, 65, 115, 11, 6, 228, 26, 205, 232, 89, 247,
                                                254, 87, 140, 105, 58, 137, 93, 158, 28, 215, 237, 179, 116, 205, 15, 228, 224, 156, 123, 133, 159, 85, 115, 121, 69,
                                                46, 15, 117, 55, 51, 13, 5, 112, 66, 70, 30, 106, 43, 139, 17, 125, 10, 175, 30, 170, 135, 196, 113, 151, 52,
                                                78, 209, 136, 150, 62, 47, 141, 56, 89, 26, 252, 237, 235, 185, 171, 180, 27, 122, 31, 140, 239, 193, 99, 61, 189,
                                                140, 230, 75, 34, 243, 207, 28, 20, 138, 53, 189, 147, 84, 51, 202, 66, 228, 238, 94, 11, 98, 175, 198, 237, 15,
                                                206, 239, 3, 26, 19, 125, 6, 66, 206, 120, 194, 145, 242, 72, 174, 33, 81, 247, 182, 255, 197, 42, 48, 168, 127,
                                                245, 159, 147, 161, 127, 189, 249, 161, 19, 57, 13, 87, 54, 207, 9, 87, 142, 63, 192, 28, 205, 228, 11, 132, 104,
                                                240, 69, 42, 183, 142, 53, 61, 121, 159, 143, 187, 75, 45, 112, 135, 47, 95, 160, 229, 247, 43, 68, 84, 16, 241,
                                                119, 36, 148, 70, 142, 164, 34, 33, 189, 203, 241, 230, 81, 73, 164, 134, 86, 67, 148, 21, 84, 187, 65, 64, 68,
                                                136, 238, 13, 130, 27, 231, 19, 43, 201, 169, 223, 82, 223, 59, 131, 204, 24, 31, 130, 232, 30, 220, 100, 197, 31,
                                                205, 99, 191, 238, 213, 22, 183, 9, 177, 214, 16, 247, 117, 31, 69, 38, 237, 207, 2, 81, 240, 121, 212, 64, 238,
                                                206, 79, 125, 39, 89, 49, 246, 100, 171, 223, 194, 238, 106, 98, 226, 198, 106, 172, 64, 32, 118, 44, 223, 191, 99,
                                                212, 159, 52, 55, 128, 90, 132, 44, 246, 107, 67, 19, 32, 224, 29, 210, 222, 3, 252, 120, 207, 37, 184, 192, 48,
                                                241, 188, 193, 184, 157, 255, 198, 92, 143, 116, 95, 225, 55, 101, 12, 76, 127, 185, 203, 57, 87, 240, 96, 79, 90,
                                                11, 54, 220, 142, 177, 81, 147, 11, 210, 160, 107, 91, 47, 64, 111, 93, 199, 156, 12, 81, 115, 79, 152, 176, 131,
                                                154, 33, 130, 35, 241, 176, 239, 58, 68, 72, 146, 68, 213, 246, 37, 216, 223, 24, 225, 98, 32, 238, 191, 156, 33,
                                                135, 147, 186, 69, 38, 183, 213, 213, 12, 81, 108, 37, 114, 56, 12, 233, 62, 164, 18, 27, 46, 229, 26, 185, 238,
                                                125, 67, 159, 248, 187, 202, 212, 116, 193, 66, 242, 135, 25, 115, 228, 31, 229, 199, 120, 144, 93, 88, 37, 156, 11,
                                                24, 124, 17, 5, 9, 237, 162, 235, 160, 15, 68, 118, 56, 81, 136, 144, 90, 184, 220, 94, 126, 208, 127, 83, 65,
                                                82, 174, 134, 2, 77, 167, 187, 221, 149, 113, 84, 65, 222, 142, 205, 209, 108, 91, 117, 96, 38, 126, 229, 69, 52,
                                                10, 176, 176, 140, 190, 230, 241, 123, 200, 160, 139, 102, 126, 91, 86, 7, 114, 248, 135, 177, 15, 11, 241, 90, 208,
                                                210, 243, 135, 38, 116, 94, 225, 15, 165, 123, 7, 10, 116, 42, 22, 106, 30, 230, 253, 205, 249, 68, 190, 90, 89,
                                                138, 21, 12, 210, 176, 180, 217, 231, 187, 154, 139, 32, 7, 50, 92, 66, 176, 202, 237, 1, 247, 75, 74, 18, 239,
                                                41, 28, 49, 145, 84, 253, 182, 72, 124, 76, 239, 94, 161, 250, 152, 25, 109, 254, 90, 51, 214, 96, 221, 75, 123,
                                                18, 85, 14, 13, 20, 227, 81, 205, 55, 247, 0, 170, 222, 99, 183, 252, 55, 110, 103, 145, 4, 137, 134, 188, 45,
                                                156, 20, 99, 17, 202, 163, 29, 155, 169, 224, 183, 134, 73, 141, 71, 112, 149, 7, 250, 206, 16, 163, 117, 14, 210,
                                                86, 214, 208, 189, 221, 202, 26, 158, 96, 253, 163, 41, 213, 209, 228, 160, 184, 91, 25, 1, 230, 249, 91, 30, 53,
                                                45, 250, 43, 4, 83, 77, 143, 21, 109, 229, 70, 105, 63, 165, 218, 252, 122, 153, 173, 68, 18, 127, 28, 138, 114,
                                                15, 82, 165, 14, 156, 83, 214, 142, 36, 172, 182, 137, 163, 119, 210, 79, 77, 57, 220, 231, 161, 210, 7, 30, 57,
                                                78, 196, 50, 36, 90, 119, 192, 211, 4, 167, 206, 181, 65, 80, 1, 78, 203, 188, 194, 158, 93, 68, 235, 196, 98,
                                                47, 237, 219, 89, 0, 242, 31, 85, 97, 92, 184, 84, 19, 57, 169, 11, 133, 226, 81, 86, 172, 96, 141, 77, 188,
                                                226, 92, 137, 14, 226, 23, 121, 76, 64, 184, 191, 107, 148, 233, 187, 115, 114, 203, 250, 183, 217, 39, 92, 42, 68,
                                                223, 155, 232, 151, 110, 240, 107, 212, 114, 10, 92, 104, 22, 43, 139, 224, 137, 213, 126, 97, 26, 62, 15, 73, 163,
                                                247, 124, 50, 14, 155, 145, 154, 30, 143, 133, 236, 60, 125, 5, 142, 100, 12, 3, 185, 150, 125, 15, 163, 77, 219,
                                                158, 130, 111, 30, 37, 185, 174, 221, 218, 142, 51, 78, 126, 220, 20, 218, 20, 195, 32, 99, 90, 181, 232, 227, 112,
                                                22, 85, 234, 69, 137, 221, 104, 91, 245, 195, 170, 192, 230, 171, 178, 114, 9, 246, 9, 243, 218, 179, 122, 144, 172,
                                                168, 15, 26, 97, 185, 74, 112, 195, 202, 223, 140, 108, 165, 44, 210, 232, 69, 58, 242, 232, 116, 232, 166, 70, 89,
                                                63, 217, 216, 100, 166, 151, 174, 210, 35, 95, 28, 21, 173, 28, 111, 181, 225, 180, 198, 195, 50, 12, 157, 119 };

const std::vector<uint8_t> doubleEncrypted = { 113, 111, 149, 65, 222, 101, 140, 141, 10, 192, 124, 225, 47, 15, 200, 7, 141, 190, 89, 49, 79, 134, 90, 177, 134,
                                               236, 65, 81, 44, 0, 243, 194, 19, 215, 47, 150, 130, 251, 245, 138, 228, 103, 218, 151, 207, 7, 146, 141, 138, 24,
                                               13, 210, 210, 243, 134, 224, 221, 70, 154, 61, 105, 200, 220, 171, 132, 80, 223, 209, 7, 167, 172, 11, 66, 184, 118,
                                               64, 202, 142, 247, 196, 28, 135, 20, 92, 57, 55, 74, 64, 142, 253, 28, 146, 2, 167, 51, 158, 187, 247, 233, 192,
                                               46, 210, 35, 197, 72, 165, 236, 111, 252, 245, 156, 232, 158, 129, 116, 28, 110, 196, 154, 54, 39, 228, 41, 18, 255,
                                               35, 186, 67, 224, 114, 204, 81, 229, 26, 215, 109, 173, 23, 88, 251, 139, 199, 0, 242, 52, 33, 148, 249, 27, 249,
                                               188, 109, 100, 64, 66, 99, 188, 108, 2, 204, 74, 5, 25, 108, 224, 234, 75, 201, 61, 115, 45, 210, 93, 242, 231,
                                               128, 243, 46, 255, 10, 194, 112, 65, 99, 44, 36, 187, 2, 167, 30, 59, 226, 128, 105, 26, 234, 241, 61, 1, 20,
                                               229, 145, 156, 85, 245, 13, 112, 107, 162, 201, 189, 105, 165, 205, 47, 117, 179, 39, 169, 135, 18, 41, 64, 159, 253,
                                               67, 59, 184, 29, 166, 252, 163, 141, 213, 186, 186, 233, 238, 202, 140, 9, 167, 192, 42, 114, 98, 102, 89, 243, 149,
                                               172, 215, 5, 62, 231, 86, 98, 212, 194, 188, 1, 21, 28, 236, 86, 32, 14, 82, 74, 146, 122, 55, 7, 87, 184,
                                               219, 147, 84, 191, 241, 108, 113, 143, 110, 188, 50, 247, 25, 174, 13, 133, 84, 164, 57, 40, 89, 114, 114, 171, 10,
                                               1, 0, 108, 37, 70, 113, 242, 236, 48, 184, 229, 246, 149, 233, 70, 156, 25, 38, 136, 243, 132, 176, 63, 191, 48,
                                               5, 249, 246, 131, 163, 174, 159, 122, 235, 212, 247, 94, 176, 238, 145, 242, 117, 161, 105, 138, 11, 33, 55, 4, 189,
                                               249, 27, 137, 142, 223, 77, 128, 229, 175, 11, 135, 236, 143, 232, 47, 209, 178, 69, 165, 194, 75, 22, 132, 145, 6,
                                               254, 255, 4, 43, 47, 21, 7, 160, 49, 48, 182, 96, 157, 228, 134, 241, 111, 150, 161, 146, 247, 33, 195, 37, 176,
                                               129, 180, 89, 151, 109, 241, 243, 64, 164, 49, 205, 161, 44, 133, 189, 7, 123, 8, 124, 253, 195, 167, 234, 5, 125,
                                               228, 87, 135, 207, 92, 238, 56, 221, 40, 220, 222, 50, 252, 11, 152, 218, 58, 220, 170, 69, 211, 90, 240, 82, 70,
                                               75, 222, 109, 111, 236, 109, 233, 247, 84, 73, 40, 147, 230, 114, 142, 51, 189, 25, 0, 8, 4, 136, 119, 120, 4,
                                               8, 122, 129, 100, 214, 159, 237, 240, 231, 143, 141, 161, 133, 243, 6, 152, 7, 82, 78, 198, 217, 100, 111, 45, 165,
                                               60, 5, 123, 50, 227, 247, 162, 113, 121, 69, 192, 24, 88, 57, 131, 152, 9, 201, 137, 209, 238, 160, 243, 158, 89,
                                               253, 44, 198, 78, 63, 134, 136, 12, 37, 214, 127, 102, 95, 241, 217, 219, 32, 67, 39, 179, 154, 185, 84, 94, 83,
                                               116, 138, 105, 134, 204, 121, 75, 150, 133, 119, 254, 246, 70, 83, 174, 242, 174, 156, 138, 67, 240, 58, 42, 33, 205,
                                               108, 37, 79, 98, 47, 17, 171, 119, 245, 158, 253, 111, 43, 69, 60, 146, 54, 220, 72, 197, 10, 91, 36, 176, 108,
                                               216, 147, 98, 224, 160, 235, 182, 44, 97, 57, 208, 69, 202, 130, 184, 237, 117, 127, 174, 68, 81, 129, 131, 153, 206,
                                               12, 60, 202, 47, 195, 6, 155, 201, 171, 245, 205, 13, 74, 95, 12, 188, 252, 250, 36, 95, 127, 20, 140, 33, 222,
                                               121, 46, 210, 176, 188, 100, 89, 61, 106, 207, 82, 42, 118, 172, 201, 139, 246, 208, 81, 229, 6, 217, 82, 93, 48,
                                               47, 236, 43, 28, 99, 76, 224, 3, 93, 170, 237, 50, 65, 151, 189, 127, 77, 146, 156, 110, 222, 167, 50, 118, 194,
                                               210, 70, 238, 225, 111, 83, 77, 212, 161, 242, 96, 153, 234, 105, 81, 111, 171, 143, 186, 138, 113, 188, 191, 95, 229,
                                               138, 97, 220, 143, 54, 104, 48, 1, 22, 179, 68, 207, 197, 95, 213, 12, 48, 110, 15, 50, 138, 162, 75, 197, 169,
                                               173, 189, 40, 184, 115, 45, 39, 180, 230, 90, 180, 10, 208, 138, 245, 174, 101, 114, 67, 221, 21, 161, 127, 188, 236,
                                               37, 55, 25, 21, 13, 238, 49, 29, 223, 83, 40, 138, 107, 181, 10, 93, 241, 13, 9, 110, 23, 141, 107, 136, 97,
                                               159, 48, 92, 24, 176, 221, 144, 238, 116, 234, 142, 10, 62, 218, 38, 184, 11, 55, 238, 16, 173, 47, 90, 4, 228,
                                               88, 97, 156, 187, 186, 95, 65, 194, 134, 110, 150, 92, 51, 74, 2, 211, 146, 26, 191, 201, 221, 133, 219, 220, 105,
                                               131, 205, 204, 86, 73, 6, 15, 238, 53, 28, 168, 34, 239, 254, 255, 101, 111, 121, 180, 25, 117, 73, 119, 62, 104,
                                               134, 249, 18, 92, 101, 30, 189, 68, 108, 193, 213, 111, 207, 46, 56, 140, 141, 228, 74, 126, 105, 195, 197, 249, 116,
                                               210, 239, 196, 235, 152, 170, 125, 21, 177, 72, 64, 34, 81, 119, 72, 122, 141, 88, 245, 9, 98, 117, 112, 187, 146,
                                               72, 122, 243, 99, 130, 179, 169, 175, 235, 171, 118, 171, 72, 44, 172, 249, 37, 21, 19, 179, 122, 90, 246, 91, 184,
                                               177, 151, 33, 241, 37, 187, 166, 157, 12, 217, 147, 156, 190, 155, 143, 146, 165, 1, 21, 83, 27, 118, 234, 11, 29,
                                               241, 15, 250, 74, 18, 95, 143, 225, 225, 219, 214, 45, 201, 52, 62, 205, 248, 68, 196, 131, 122, 26, 46, 36, 15,
                                               188, 187, 11, 203, 161, 247, 51, 242, 213, 149, 226, 71, 189, 114, 49, 4, 146, 210, 92, 156, 76, 82, 8, 69, 10,
                                               54, 230, 70, 7, 215, 6, 46, 45, 123, 116, 54, 245, 58, 102, 12, 43, 8, 138, 125, 223, 10, 116, 171, 143, 159,
                                               64, 4, 16, 86, 71, 247, 53, 89, 28, 86, 215, 192, 215, 127, 215, 182, 160, 193, 220, 63, 40, 204, 104, 181, 187,
                                               38, 1, 179, 51, 39, 52, 144, 132, 202, 131, 97, 57, 174, 169, 151, 80, 136, 207, 126, 202, 71, 94, 75, 101, 188,
                                               124, 201, 98, 115, 129, 91, 0, 245, 234, 237, 138, 111, 183, 24, 130, 74, 221, 215, 180, 44, 14, 212, 230, 220, 193,
                                               141, 207, 124, 165, 107, 4, 146, 167, 250, 111, 190, 22, 232, 204, 216, 233, 173, 190, 194, 49, 32, 186, 193, 129, 10,
                                               160, 199, 148, 232, 214, 209, 187, 72, 53, 168, 138, 207, 185, 208, 18, 54, 245, 157, 214, 70, 94, 37, 93, 104, 29,
                                               64, 197, 203, 87, 158, 20, 222, 128, 243, 111, 231, 43, 164, 99, 198, 9, 179, 210, 180, 105, 63, 89, 86, 221, 142,
                                               226, 89, 163, 201, 140, 162, 215, 242, 97, 14, 194, 113, 52, 249, 244, 164, 12, 155, 217, 225, 137, 15, 110, 65, 151,
                                               219, 146, 11, 109, 67, 198, 202, 201, 18, 24, 89, 21, 141, 165, 10, 174, 243, 12, 248, 142, 215, 216, 241, 89, 243,
                                               128, 253, 53, 139, 192, 162, 69, 224, 92, 127, 110, 199, 166, 71, 249, 146, 67, 110, 136, 219, 109, 244, 131, 190, 7,
                                               92, 77, 45, 155, 68, 2, 76, 192, 70, 35, 5, 28, 47, 158, 230, 19, 140, 29, 50, 48, 35, 136, 73, 8, 21,
                                               115, 34, 19, 91, 34, 25, 23, 87, 237, 24, 117, 200, 91, 69, 102, 251, 89, 150, 146, 156, 103, 208, 104, 13, 180,
                                               251, 211, 162, 178, 23, 122, 117, 163, 45, 80, 11, 200, 38, 101, 246, 253, 121, 220, 202, 74, 157, 204, 243, 36, 205,
                                               229, 101, 189, 31, 120, 39, 12, 224, 183, 166, 124 };

const std::array<uint8_t, 64> hashedPassword500k = { 103, 140, 7, 142, 172, 154, 115, 147, 106, 161, 207, 148, 4, 214, 64, 156, 209, 239, 193, 197, 22, 100, 61, 86, 75,
                                                     98, 21, 201, 146, 29, 115, 6, 121, 255, 155, 18, 125, 255, 135, 133, 193, 147, 44, 205, 41, 93, 191, 10, 237, 124,
                                                     2, 198, 104, 33, 38, 214, 121, 112, 39, 120, 96, 62, 183, 223, };

const std::array<uint8_t, 64> hashedPassword100k = { 212, 79, 181, 104, 96, 88, 146, 239, 47, 128, 249, 90, 205, 232, 248, 223, 140, 230, 189, 172, 110, 194, 15, 135, 161,
                                                     103, 71, 93, 237, 151, 228, 211, 113, 203, 222, 141, 180, 242, 98, 42, 38, 234, 50, 222, 108, 215, 224, 124, 136, 144,
                                                     221, 0, 92, 57, 111, 82, 222, 243, 67, 77, 5, 214, 91, 136 };


const std::string password = "StrongPasswordNotReally";
std::array<uint8_t, 64> hashedKey;

using namespace PNGStego::Encryption;

std::vector<uint8_t> IV;
std::vector<uint8_t> salt;

void init() {
	const int IV_BYTES = 12;       // 96 bits
	const int SALT_BYTES = 16;     // 128 bits

	IV.resize(IV_BYTES);
	for (int i = 0; i < IV_BYTES; ++i) {
		IV[i] = static_cast<uint8_t>(i);
	}

	salt.resize(SALT_BYTES);
	for (int i = 0; i < SALT_BYTES; ++i) {
		salt[i] = static_cast<uint8_t>(SALT_BYTES - i);
	}

	hashedKey = hashKey<64>(password, salt);
}

bool testAESEncryption() {
	std::vector<uint8_t> temp = AESEncrypt(originalData, hashedKey.data(), hashedKey.size() - 32, IV.data(), IV.size());
	return temp == AESEncrypted;
}

bool testSerpentEncryption() {
	std::vector<uint8_t> temp = SerpentEncrypt(originalData, hashedKey.data() + 32, hashedKey.size() - 32, IV.data(), IV.size());
	return temp == SerpentEncrypted;
}

bool testAESDecryption() {
	std::vector<uint8_t> temp = AESDecrypt(AESEncrypted, hashedKey.data(), hashedKey.size() - 32, IV.data(), IV.size());
	return temp == originalData;
}

bool testSerpentDecryption() {
	std::vector<uint8_t> temp = SerpentDecrypt(SerpentEncrypted, hashedKey.data() + 32, hashedKey.size() - 32, IV.data(), IV.size());
	return temp == originalData;
}

bool testPBKDF2() {
	std::array<uint8_t, 64> temp = hashKey<64, 100000>(password, salt);
	return temp == hashedPassword100k &&
		   hashedKey == hashedPassword500k;
}

bool testDoubleEncryption() {
	std::vector<uint8_t> temp = encrypt(originalData, password, IV, salt);
	return temp == doubleEncrypted;
}

bool testDoubleDecryption() {
	std::vector<uint8_t> temp = decrypt(doubleEncrypted, password, IV, salt);
	return temp == originalData;
}

bool testWithRandomData() {
	std::random_device rd;
	std::mt19937 mt(rd());
	std::uniform_int_distribution<size_t> randomSize(100, 200);
	std::uniform_int_distribution<uint8_t>  randomData(0, 0xFF);


	std::vector<uint8_t> container;
	std::vector<uint8_t> encryptedData;
	const int iterations = 100;
	for (int i = 0; i < iterations; ++i) {
		size_t size = randomSize(mt);
		container.resize(size);
		for (size_t j = 0; j < size; ++j) {
			container[j] = randomData(mt);
		}
		encryptedData = SerpentEncrypt(container, hashedKey.data() + 32, hashedKey.size() - 32, IV.data(), IV.size());
		encryptedData = AESEncrypt(encryptedData, hashedKey.data(), hashedKey.size() - 32, IV.data(), IV.size());
		std::vector<uint8_t> decryptedData;
		decryptedData = AESDecrypt(encryptedData, hashedKey.data(), hashedKey.size() - 32, IV.data(), IV.size());
		decryptedData = SerpentDecrypt(decryptedData, hashedKey.data() + 32, hashedKey.size() - 32, IV.data(), IV.size());
		if (decryptedData != container)
			return false;
	}
	return true;
}

int main() {
	std::cout << "Initializing IV, salt and a derived key: ";
	init();
	std::cout << "Done.\n";

	int tests = 0;
	int successes = 0;

	std::cout << "Testing AESEncrypt() with precomputed data...: ";
	++tests;
	if (testAESEncryption()) {
		std::cout << "PASSED!\n";
		++successes;
	} else {
		std::cout << "FAILED!\n";
	}

	std::cout << "Testing SerpentEncrypt() with precomputed data...: ";
	++tests;
	if (testSerpentEncryption()) {
		std::cout << "PASSED!\n";
		++successes;
	} else {
		std::cout << "FAILED!\n";
	}

	std::cout << "Testing AESDecrypt() with precomputed data...: ";
	++tests;
	if (testAESDecryption()) {
			std::cout << "PASSED!\n";
			++successes;
	} else {
		std::cout << "FAILED!\n";
	}

	std::cout << "Testing SerpentDecrypt() with precomputed data...: ";
	++tests;
	if (testSerpentDecryption()) {
		std::cout << "PASSED!\n";
		++successes;
	} else {
		std::cout << "FAILED!\n";
	}

	std::cout << "Comparing derived keys with precomputed ones...: ";
	++tests;
	if (testPBKDF2()) {
		std::cout << "PASSED!\n";
		++successes;
	} else {
		std::cout << "FAILED!\n";
	}

	std::cout << "Testing double encryption with precomputed data...: ";
	++tests;
	if (testDoubleEncryption()) {
		std::cout << "PASSED!\n";
		++successes;
	} else {
		std::cout << "FAILED!\n";
	}

	std::cout << "Testing double decryption with precomputed data...: ";
	++tests;
	if (testDoubleDecryption()) {
		std::cout << "PASSED!\n";
		++successes;
	} else {
		std::cout << "FAILED!\n";
	}

	std::cout << "Testing (de-/en-)cryption with random data...: ";
	++tests;
	if (testWithRandomData()) {
		std::cout << "PASSED!\n";
		++successes;
	} else {
		std::cout << "FAILED!\n";
	}

	std::cout << "\nTESTS: " << tests;
	std::cout << "\nPASSED: " << successes;
	std::cout << "\nFAILED: " << tests - successes << std::endl;

	return !(successes == tests);
}
